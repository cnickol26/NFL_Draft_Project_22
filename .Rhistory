library(tidyverse)
library(gganimate)
library(ggplot2)
library(cowplot)
library(repr)
#loading command to make NFL field in ggplot (credit to Marschall Furman)
source("https://raw.githubusercontent.com/mlfurman3/gg_field/main/gg_field.R")
plays <- read.csv("https://media.githubusercontent.com/media/cnickol26/BigDataBowl2023/main/nfl-big-data-bowl-2023/plays.csv")
plays$uniqueplayId <- as.numeric(paste(as.character(plays$gameId),
as.character(plays$playId), sep=""))
plays <- read.csv("https://media.githubusercontent.com/media/cnickol26/BigDataBowl2023/main/nfl-big-data-bowl-2023/plays.csv")
plays <- read.csv("https://media.githubusercontent.com/media/cnickol26/BigDataBowl2023/main/nfl-big-data-bowl-2023/plays.csv")
plays$uniqueplayId <- as.numeric(paste(as.character(plays$gameId),
as.character(plays$playId), sep=""))
weeks <-read.csv("data_subset.csv")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidyquant)
library(readr)
library(purrr)
draft_model_wr <- read.csv("wr_model_data.csv")
View(draft_model_wr)
draft_model_wr<-draft_model_wr %>% na.omit()
ggplot(aes(x = draft_model_wr$Overall)) %>% geom_histogram()
ggplot(draft_model_wr, aes(x = Overall)) %>% geom_histogram()
ggplot(draft_model_wr, aes(x = Overall)) + geom_histogram()
train<-draft_model_wr %>% filter(Year < 2020) %>% mutate(P_five=as.factor(P_five))
test<-draft_model_wr %>% filter(Year > 2019) %>% mutate(P_five=as.factor(P_five))
result<-lm(Overall~Rec.Yards+Rec.TD+Rec+RAS+P_five,data=train)
test$predict<-round(predict(result,newdata = test))
test_mse_ln<-mean((test$Overall-test$predict)^2)
test_mse_ln
summary(result)
yhat<-result$fitted.values
res<-result$residuals
Data<-data.frame(train,yhat,res)
ggplot(Data, aes(x=yhat,y=res))+
geom_point()+
geom_hline(yintercept=0, color="red")+
labs(x="Fitted y",
y="Residuals",
title="Residual Plot")
acf(res,main="ACF Plot of Residuals")
qqnorm(res)
qqline(res, col="red")
setwd("/Users/connornickol/Documents/R Projects/NFL_Draft_Project_22")
